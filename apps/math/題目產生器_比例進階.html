<!Doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.css" integrity="sha384-exe4Ak6B0EoJI0ogGxjJ8rn+RN3ftPnEQrGwX59KTCl5ybGzvHGKjhPKk/KC3abb" crossorigin="anonymous">
        <style>
            table{
                font-size: 20px;
            }
            tr{
            	height: 70px ;
            }
            input{
            	max-width: 30px;
                text-align: center;
            }
            b{
                color: blue ;
            }
            .katex { font-size: 1.5em; }
            .answer{
                visibility: hidden;
                text-align: left;
                color: blue;
            }
        </style>
    </head>
    <body>
        <table>       	
            
            <tbody id="data">
                
                <tr>
                    <td colspan="3"><h3>練習題 - 求比值</h3></td>
                    <td><button style="height: 50px;width: 100px;" onclick="check();">檢視答案</button></td>
                </tr>
                
               
            </tbody>        	
        </table>
       
    </body>
    <script src="lib/algebra-0.2.6.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.js" integrity="sha384-OMvkZ24ANLwviZR2lVq8ujbE/bUO8IR1FdBrKLQBI14Gq5Xp/lksIccGkmKL8m+h" crossorigin="anonymous"></script>
    
    <script>
        
        
        var Fraction = algebra.Fraction;
        var Expression = algebra.Expression;
        var Equation = algebra.Equation;        
        
        var no = 1 ;        
        
        function eq_type1_prepare( target , n ){
            
            for(var i=1 ; i<=n ; i++){

                target.innerHTML = target.innerHTML 
                    +"<tr><td> ("+i+") </td>"
                    +"<td id='q"+i+"' style='width: 300px;text-align: left;'></td>"
                    +"<td></td>"
                    +"<td id='qa"+i+"' class='answer'</td>"                   
                    +"</tr>" ;                   
                
            }
            
            
        }
        function eq_type1(n ){
            
            for(var i=1 ; i<=n ; i++){
                var q  = document.getElementById('q'+i);
                var qa = document.getElementById('qa'+i);
                eq(q,qa) ;           
                
            }
            
            
        }        
        
        
        function eq( target , target_answer){

            var f1 = genFractionNumber() ;
            var f2 = genIntegerFractionNumber() ;

            var c1 = genNumber(5,false)+1 ;
            var c2 = genNumber(5,false)+1 ;

            var render_context = "a:b="+toFractionString(f1)+":"
                                        +toFractionString(f2)+"\\implies"
                                        +c1+"a:"+c2+"b=?" ;

            katex.render( render_context , target);

            f1 = f1.multiply(c1) ;
            f2 = f2.multiply(c2) ;
            var f = f1.divide(f2) ;
            //render_context = "a:b="+f.numer+":"+f.denom ;
            render_context = c1+"a:"+c2+"b="+toFractionString(f) ;
            katex.render( render_context , target_answer);

            
        }

        function genFractionNumber(){
            var a1 = genNumber( 9 , true ) ;
            var a2 = genNumber( 9 , true ) ;            
            var frac = new Fraction(a1,a2);
            return frac.multiply(1) ;
        }
        function genIntegerFractionNumber(){
            var a1 = genNumber( 9 , true ) ;
            var a2 = genNumber( 0 , true ) ;            
            var frac = new Fraction(a1,a2);
            return frac.multiply(1) ;
        }        

        function toFractionString(frac){
            if( frac.denom === 1){
                return frac.toString() ;
            }else{
                return "\\frac{"+frac.numer+"}{"+frac.denom+"}" ;
            }
        }
        
        
        function genNumber( top , negative ){

        	var n = Math.floor(Math.random()*top)+1;
        	if( negative ){
                if( Math.random() > 0.5 ){
                    return n ;
                }else{
                    return n*(-1) ;
                }
            }else{
                return n ;
            }
        }

        function genPolar(){
            return Math.random()>0.5?1:-1;
        }
        
        
        function check(){
        
            var input = prompt("準備好看答案了嗎？ 是的話請輸入 y") ;
	       if( input=='y'){
               var its = document.getElementsByClassName('answer') ;
               for( var i=0 ; i<its.length ; i++){
                   its[i].style.visibility = "visible"; 
               }
           }


        }
        
        var e = document.getElementById("data") ;
        eq_type1_prepare(e , 3) ;
        eq_type1(3) ;
        //-----------------------------------------
        
        
  
        
    </script>
</html>
